---
page_title: "env_ensure function - corefunc"
subcategory: ""
description: |-
  Ensures that a given environment variable is set to a non-empty value.
  If the environment variable is unset or if it is set to an empty string,
  it will trigger a Terraform-level error.
  -> Not every Terraform provider checks to ensure that the environment variables it
  requires are properly set before performing work, leading to late-stage errors.
  This will force an error to occur early in the execution if the environment
  variable is not set, or if its value doesn't match the expected patttern.
  Maps to the corefunc.EnvEnsure() https://pkg.go.dev/github.com/northwood-labs/terraform-provider-corefunc/corefunc#EnvEnsure Go method, which can be used in
  Terratest https://terratest.gruntwork.io.
---

# env_ensure (function)

Ensures that a given environment variable is set to a non-empty value.
If the environment variable is unset or if it is set to an empty string,
it will trigger a Terraform-level error.

-> Not every Terraform provider checks to ensure that the environment variables it
requires are properly set before performing work, leading to late-stage errors.
This will force an error to occur early in the execution if the environment
variable is not set, or if its value doesn't match the expected patttern.

Maps to the [`corefunc.EnvEnsure()`](https://pkg.go.dev/github.com/northwood-labs/terraform-provider-corefunc/corefunc#EnvEnsure) Go method, which can be used in
[Terratest](https://terratest.gruntwork.io).

## Signature

<!-- signature generated by tfplugindocs -->
```text
env_ensure(name string, pattern string...) string
```

## Example Usage

### `AWS_DEFAULT_REGION` is defined (no error)

```terraform
# AWS_DEFAULT_REGION="us-east-1"

output "aws_default_region" {
  value = provider::corefunc::env_ensure("AWS_DEFAULT_REGION")
}

#=> us-east-1
```

### `AWS_PAGER` is set to an empty string (error)

```terraform
# AWS_PAGER=""

output "aws_pager" {
  value = provider::corefunc::env_ensure("AWS_PAGER")
}

#=> [Error] Problem with Environment Variable: environment variable
#=>         AWS_PAGER is not defined
```

### `AWS_VAULT` is defined, but does not match pattern (error)

```terraform
# AWS_VAULT="dev"

output "aws_vault" {
  # Must end with "prod" or "nonprod".
  value = provider::corefunc::env_ensure("AWS_VAULT", "(non)?prod$")
}

#=> [Error] Invalid value for "name" parameter:
#=>         environment variable AWS_VAULT does not match pattern (non)?prod$
```

### Example plan output

```bash
AWS_DEFAULT_REGION="us-east-1" AWS_VAULT="dev" terraform plan
```

```plain
Error: Invalid function argument

  on function.AWS_PAGER.tf line 4, in output "aws_pager":
  4:   value = provider::corefunc::env_ensure("AWS_PAGER")
    ├────────────────
    │ while calling provider::corefunc::env_ensure(name, pattern...)

Invalid value for "name" parameter: environment variable AWS_PAGER is not defined.

Error: Invalid function argument

  on function.AWS_VAULT.tf line 4, in output "aws_vault":
  4:   value = provider::corefunc::env_ensure("AWS_VAULT", "(non)?prod$") # Must end with "prod" or "nonprod".
    ├────────────────
    │ while calling provider::corefunc::env_ensure(name, pattern...)

Invalid value for "name" parameter: environment variable AWS_VAULT does not match pattern (non)?prod$.
```

## Arguments

<!-- arguments generated by tfplugindocs -->
1. `name` (String) The name of the environment variable to check.
<!-- variadic argument generated by tfplugindocs -->
1. `pattern` (Variadic, String, Nullable) A valid Go ([re2](https://github.com/google/re2/wiki/Syntax)) regular expression pattern.

<!-- Preview the provider docs with the Terraform registry provider docs preview tool: https://registry.terraform.io/tools/doc-preview -->
